<!DOCTYPE html>
<html>
<head>
  <title>codeQuest</title>
  <link rel="stylesheet" type="text/css" href="<%=url('test.css')%>">
  <link rel="icon" type="image/png" href="/favicon2.png">
</head>
<% @id = session[:account_id] %>
<% @account_theme = Account.find(@id).theme_light %>
<% if @account_theme %>
  <link rel="stylesheet" type="text/css" href="/color-scheme-light.css">
<% else %>
  <link rel="stylesheet" type="text/css" href="/color-scheme-dark.css">
<% end %>
<body>
  <header class="container">
    <a href='/home'>
      <h1 class="logo">
        <img src="/favicon2.png" alt="Logo">
        <span>codeQuest</span>
      </h1>
    </a>
    <nav class="nav-links">
      <ul>
        <li><a href="/home" class="nav-link">Inicio</a></li>
        <li><a href="/profile" class="nav-link">Perfil</a></li>
        <li><a href="/snippets" class="nav-link">Snippets</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- Titulo -->
    <h1 id="test-title">Test <%= @test.letter %></h1>
    <!-- Pregunta -->
    <section id="question-sec">
      <%= @question.content %>
    </section>
    <!-- Respuesta -->
    <section id="answer-sec">
      <!-- Opciones de respuesta -->
      <h2>Tu respuesta:</h2>
      <% @options.each do |option| %>
      <label class="option-button">
        <input form="user-answer" type="radio" name="selected_option" value="<%= option.number %>" hidden>
        <%= option.content %>
      </label>
      <% end %>
      <!-- Botón de envío -->
      <input form="user-answer" name="question_number" value="<%= @question.number %>" hidden>
      <input form="user-answer" name="test_letter" value="<%= @test.letter %>" hidden>
    </section>
    <div class="answer-button-container" >
      <button form="user-answer" type="submit" class="answer-button" id="answerButton" disabled="disabled"><b>Responder</b></button>
    </div>
    <form id="user-answer" action="/submit_answer" method="post" hidden></form>

  </main>
  <script>
    const answerButton = document.getElementById('answerButton');
    const optionButtons = document.querySelectorAll('.option-button');

    optionButtons.forEach(function(button) {
      button.addEventListener('click', function() {
        // Remove the 'selected' class from all option buttons
        optionButtons.forEach(function(btn) {
          btn.classList.remove('selected');
        });

        // Add the 'selected' class to the clicked option button
        button.classList.add('selected');

        answerButton.classList.remove('enabled', 'answer-button-animation');
        setTimeout(function() {
          answerButton.classList.add('enabled', 'answer-button-animation');
          answerButton.removeAttribute('disabled');
        }, 10);
      });
    });

    answerButton.addEventListener('click', function() {
      answerButton.classList.toggle('enabled');
    });
  </script>
</body>
</html>
